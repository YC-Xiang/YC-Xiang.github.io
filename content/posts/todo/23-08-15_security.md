---
title: 安全加密算法
date: 2023-08-15 17:39:28
draft: true
tags:
- 加密算法
categories:
- Notes
---

# 1. 非可逆加密

## 1.1 SHA256

https://en.wikipedia.org/wiki/SHA-2 Pseudocode伪代码流程

https://zhuanlan.zhihu.com/p/94619052

### 概述

对于任意长度的消息，SHA256都会产生一个**256位**的哈希值。

- 对消息进行补位处理，最终的长度是**512位的倍数**。
- 以512位为单位对消息进行分块为M1, M2, …, Mn。

消息区块将进行逐个处理：从一个固定的初始哈希$H^{0}$开始，进行以下序列计算：

$H^{(i)}=H^{(i-1)}+C_{M^{i}}(H^{(i-1)})$

C是SHA256压缩函数，+是mod $2^{32}$加法，相加后对$2^{32}$取余。

### 常量初始化

> code中的iv向量即初始化哈希

初始哈希值$H^0$取自然数前八个素数(2, 3, 5, 7, 11, 13, 19)的平方根的小数部分。并且取前面的32位。

比如根号2的小数部分为0.414213562373095048约等于$6*16^{-1}+a*16^{-2}+0*16^{-3}...$

$H^{0}$对应0x6a09e667

```c
#define SHA256_DIGEST_SIZE
const U8 g_cbySha256IV[SHA256_DIGEST_SIZE]=
{
	0x6A, 0x09, 0xE6, 0x67,
	0xBB, 0x67, 0xAE, 0x85,
	0x3C, 0x6E, 0xF3, 0x72,
	0xA5, 0x4F, 0xF5, 0x3A,
	0x51, 0x0E, 0x52, 0x7F,
	0x9B, 0x05, 0x68, 0x8C,
	0x1F, 0x83, 0xD9, 0xAB,
	0x5B, 0xE0, 0xCD, 0x19
};
```

### 消息预处理

对消息进行补码处理: 假设M的二进制编码长度为$l$位，首先在消息末尾补上一位"1"，然后再补上$k$个"0", k为下列方程最小数。

$$l+1+k \equiv 448\space mod\space512 $$

> $\equiv$是同余符号，表示取余后相同

最后还要补充64bits $l$即长度的二进制表示，形成512bits的倍数。

将补码处理后的消息以512bit为单位分块: $M^1, M^2, ...,M^N$,

第i个消息块总共512bits又以32bits为单位分为16个消息块:$M_0^i, M_1^i,...,M_{15}^i$

> 例如补充完消息为512bits，那么只有$M^1$大块，和其中的16小块。

见参考链接对"abc"的补码过程。

### 摘要计算主循环

$For\space i=1\rightarrow N$

用(i-1)个中间哈希对a,b,c,d,e,f,g,h初始化，当i=1时，就使用初始化哈希常量

$$a\leftarrow H_1^{i-1} \\ b\leftarrow H_2^{i-1} \\ ...\\h\leftarrow H_8^{i-1}$$

应用SHA256压缩函数来更新a,b,c,...,h

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230731145934.png)

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230731145958.png)

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230731150022.png)

# 2. 可逆加密

## 2.1 对称加密

### AES

https://zhuanlan.zhihu.com/p/78913397

https://blog.csdn.net/qq_28205153/article/details/55798628

AES 是对称加密算法，也就是说加密和解密都是采用同一个的密钥。

AES把明文分成一组一组，每次加密一组数据，直到加密完整个明文。AES标准规范中，分组长度只能是**128位**。密钥的长度可以使用**128位**、**192位**或**256位**。密钥的长度不同，推荐加密轮数也不同。

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230731173545.png)

下面展示的是明文和密钥长度都为128bits长度的AES。

AES的整体结构如下图所示，其中的W[0,3]是指W[0]、W[1]、W[2]和W[3]串联组成的128位密钥。加密的第1轮到第9轮的轮函数一样，包括4个操作：字节代换、行位移、列混合和轮密钥加。**最后一轮**迭代不执行列混合。另外，在**第一轮迭代之前**，先将明文和原始密钥进行一次异或加密操作。

#### 工作流程

下面应该介绍的是ECB工作模式？

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230801141720.png)

#### **密钥加法层**

将一组明文和一组密钥进行异或操作。

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230731175508.png)

#### **字节代换层**

把上面得到的矩阵每个字节的高4位作为行值，低4位作为列值，查找S盒对应的映射。相当于一个查表替换的操作。解密时用逆S盒。

#### **行位移层**

加密：

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230801094130.png)

解密相反，第一行不变，第二行向右移动一个字节...

#### **列混淆层**

与下图中的正矩阵相乘，这里的矩阵乘法与普通的加减法不同。解密会乘不同的矩阵。

![](https://xyc-1316422823.cos.ap-shanghai.myqcloud.com/20230801140325.png)

#### **密钥扩展**

下一轮aes计算的密钥W[4]~W[7] 由W[0]~W[3]生成。

### 工作模式

#### ECB

#### CBC

#### CTR

#### CCM

#### GCM

## 2.2 非对称加密

### RSA

### ECC

椭圆加密曲线Elliptic curve cryptography



# Hmac



# CRC

# TRNG
